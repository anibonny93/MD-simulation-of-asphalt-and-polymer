PE_pppm=[0.290959164	0.0404069295	0.2873005778	0.2946177502
0.5642402267	0.0420961055	0.5604286966	0.5680517569
0.0982237642	0.0424903213	0.0943765403	0.1020709881
0.2104135011	0.0366343617	0.2070964965	0.2137305057
0	0	0	0
0.0023348647	0.0454469636	-0.001780064	0.0064497934
-0.0302081362	0.044237569	-0.034213562	-0.0262027103
0.0348778656	0.0466563583	0.030653434	0.0391022972
0	0	0 0
0.151664103	0.0501031513	0.1471275866	0.1562006194
-0.0360471584	0.0415695855	-0.0398110156	-0.0322833012
-0.0972583681	0.0421997472	-0.1010792823	-0.0934374538
0.0752004523	0.0385580497	0.0717092702	0.0786916344
0.0597838593	0.0330539135	0.0567910412	0.0627766775
0.7566417296	0.0951344605	0.7480279193	0.7652555399
0	0	0	0
0.0996239487	0.0356627621	0.0963949162	0.1028529813
-0.0017710363	0.0319808269	-0.0046666934	0.0011246208
0.2010189338	0.0393446972	0.1974565258	0.2045813417];


PB=[0.0744366333	0.0406174974	0.0240033492	0.1248699175
0.1735867011	0.0420011921	0.121435333	0.2257380691
-0.0543152594	0.0561310462	-0.1240111586	0.0153806398
0.1040384583	0.0237202539	0.074585873	0.1334910435
0	0	0	0
0.2300352537	0.0562157645	0.1602341628	0.2998363446
0.1708657185	0.0305625115	0.1329173483	0.2088140887
0.2892047888	0.0818690175	0.1875509772	0.3908586005
0	0	0	0
0.258624427	0.0440313467	0.203952289	0.313296565
0.7618844256	0.0499955459	0.6998067562	0.8239620949
0.1221217256	0.0520806317	0.0574550803	0.1867883709
0.0822407435	0.0313214715	0.04335	0.121131487
0.1752839174	0.0526798135	0.1098732896	0.2406945453
0.1515913229	0.0340792712	0.1092763187	0.193906327
0	0	0	0
0.0960137921	0.0297051523	0.059129974	0.1328976102
0.054148226	0.0268912886	0.0207582811	0.0875381708
0.1378793582	0.0325190159	0.0975016669	0.1782570496];


%PP_Ewald=[0.5479937858	0.0479436326	0.4884639032	0.6075236684
%0.718915804	0.0632172851	0.640421177	0.7974104309
%0.3537196223	0.0537281677	0.2870072909	0.4204319538
%0.5713459311	0.0268854451	0.5379632418	0.6047286204
%0	0	0	0
%0.7672056099	0.0560784161	0.6975750595	0.8368361603
%0.6866477872	0.0667211603	0.6038025245	0.7694930499
%0.8477634325	0.045435672	0.7913475944	0.9041792706
%0	0	0	0
%0.7233442107	0.0509120958	0.6601284942	0.7865599271
%1.5174054328	0.0385113543	1.4695872706	1.5652235949
%0.0730836957	0.0469032428	0.0148456277	0.1313217637
%0.592475797	0.0509144139	0.5292572023	0.6556943916
%0.712781731	0.0734204402	0.6216182136	0.8039452483
%0.720974397	0.0448110279	0.6653341569	0.776614637
%0	0	0	0
%0.5368362608	0.0484905782	0.4766272555	0.597045266
%0.4629642253	0.0353595027	0.4190596039	0.5068688468
%0.6107082962	0.0616216538	0.5341949071	0.6872216853];


PP_PPPM=[0.547993785798493	0.087212202658129	0.364244803407202	0.183748982391291	0.912238589205695	0.304842050559049	0.243151735239444	0.852835836357541
0.718915803966748	0.063217285071961	0.264029193979165	0.454886609987583	0.982944997945913	0.220970073278114	0.497945730688634	0.939885877244862
0.353719622335726	0.053728167665349	0.224397564471675	0.129322057864051	0.578117186807401	0.187801756000698	0.165917866335028	0.541521378336424
0.571345931093004	0.026885445131839	0.112287998446157	0.459057932646847	0.683633929539161	0.093975544412176	0.477370386680828	0.66532147550518
0	0	0	0	0	0	0	0
0.76720560986747	0.080722447430588	0.337140114556687	0.430065495310783	1.10434572442416	0.282157721636122	0.485047888231349	1.04936333150359
0.68664778722566	0.066721160311967	0.278663251015454	0.407984536210206	0.965311038241114	0.233217539578829	0.453430247646831	0.919865326804489
0.847763432509281	0.04543567195287	0.189763667167332	0.657999765341949	1.03752709967661	0.158816117291931	0.68894731521735	1.00657954980121
0	0	0	0	0	0	0	0
0.723936664104546	0.108008690284849	0.45110205865678	0.272834605447766	1.17503872276133	0.377534216784991	0.346402447319555	1.10147088088954
1.51740543278595	0.038511354284461	0.160844013139728	1.35656141964622	1.67824944592568	0.134612816235148	1.3827926165508	1.6520182490211
0.073083695709478	0.046903242801493	0.195893027955735	-0.122809332246257	0.268976723665213	0.163945873142597	-0.090862177433119	0.237029568852075
0.59247579695453	0.05091441385866	0.212645823649679	0.379829973304851	0.805121620604209	0.177966544252157	0.414509252702373	0.770442341206687
0.712781730968226	0.07342044023539	0.306643027059438	0.406138703908788	1.01942475802766	0.25663424236675	0.456147488601476	0.969415973334976
0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0
0.462964225311458	0.035359502653102	0.147680194971603	0.315284030339855	0.610644420283061	0.123595815344482	0.339368409966976	0.58656004065594
0.462964225311458	0.035359502653102	0.147680194971603	0.315284030339855	0.610644420283061	0.123595815344482	0.339368409966976	0.58656004065594
0	0	0	0	0	0	0	0
];

PS=[0.5489348939	0.0695199892	0.4814868557	0.6163829322
0.0317663181	0.0671517928	-0.0188696516	0.0824022878
1.3379311051	0.070324772	1.2849025428	1.3909596673
0.2771072586	0.0710834028	0.1784276757	0.3757868414
0	0	0	0
0.0862467524	0.0669160917	0.0357885138	0.1367049911
0.12274394	0.0646821191	0.0739702337	0.1715176464
0.0497495649	0.0691500642	-0.0023932061	0.1018923359
0	0	0	0
0.1672485242	0.0705524238	0.1025510045	0.2426170198
0.1331887364	0.0999902537	0.0331984827	0.2331789901
0.1055525437	0.0595201211	0.0606712543	0.1504338331
0.0955682615	0.0595073409	0.0506966091	0.140439914
0.1959054319	0.0712752765	0.1246301554	0.3205355873
0.3060276477	0.0624691267	0.243558521	0.3684967744
0	0	0	0
0.1008390952	0.0568633459	0.0439757493	0.1577024411
0.2886781903	0.0587266918	0.2299514985	0.3474048821
-0.087	0.055	-0.142	-0.032];


PVC_PPPM=[-0.1357703044	0.0773089824	-0.1427701329	-0.1287704759
0.4040975548	0.0720526459	0.3975736536	0.410621456
-0.3428517217	0.0771637242	-0.349838398	-0.3358650454
-0.4685567463	0.0827105772	-0.4760456543	-0.4610678383
0	0	0	0
-0.8336179258	0.0705491809	-0.840005698	-0.8272301536
-0.9800008704	0.0752290027	-0.9868123702	-0.9731893706
-0.6872349812	0.0658693591	-0.6931990258	-0.6812709366
0	0	0	0
-0.4352077877	0.0734133884	-0.4418548953	-0.42856068
-0.8377202976	0.0745235873	-0.8444679266	-0.8309726686
-0.0326952778	0.0723031895	-0.0392418641	-0.0261486914
0	0	0	0
-0.5594141388	0.0792666668	-0.566591223	-0.5522370546
0.1348245426	0.072360753	0.1282727442	0.1413763409
-0.386804814	0.0832827502	-0.3943455286	-0.3792640995
-0.0284071069	0.0614015716	-0.0339666222	-0.0228475916
-0.1387732939	0.0668043347	-0.1448219945	-0.1327245933
-2.3779100218	0.1124839244	-2.3880947139	-2.3677253297];


%row1=400
%row2=500

types={'Asphaltenes'
'Asphaltene Phenol'
'Asphaltene Pyrrole'
'Asphaltene Thiophene'
'-'
'Aromatics'
'Dioctylcyclohexane Naphthalene'
'Perhydrophenanthrene Napththalene'
' -- '
'Resins'
'Benzobisbenzothiophene'
'Trimethylbenzeneoxane'
'Thioisorenieratane'
'Quinolinohopane'
'Pyridinohopane'
'  ---  '
'Saturates'
'Squalane'
'Hopane'
};

X=categorical(types);
X=reordercats(X,types);

%%%%%%%%%%%%%%%%%%%%%%%%%%% All
        X=categorical(types);
X=reordercats(X,types); 
A=[PE_pppm(:,1),PB(:,1),PP_PPPM(:,1),PS(:,1),PVC_PPPM(:,1)]

 figure
 hold on
b=bar(X,A)
colors=[[0 1 0];[0 0 1];[1 0 0]]
% colors=[[0 0 1];[0.5 0.5 1]]
colorsarray=[2 3 4 6 7 8];
for k = 1:size(b,2)
    b(k).FaceColor = PetersColorMap(colorsarray(k));
end

ErrCol=2;
Errors=[PE_pppm(:,ErrCol),PB(:,ErrCol),PP_PPPM(:,ErrCol),PS(:,ErrCol),PVC_PPPM(:,ErrCol)]
p=0.025;
Nerr=4;
tval=tinv(1-p,Nerr);
Errors=[PE_pppm(:,ErrCol)*tval,PB(:,ErrCol)*tval,PP_PPPM(:,ErrCol)*tval,PS(:,ErrCol)*tval,PVC_PPPM(:,ErrCol)*tval]

%%%%%%%%%%%% Calculate the number of groups and number of bars in each group
[ngroups,nbars] = size(A);
% Get the x coordinate of the bars
x = nan(nbars, ngroups);
for i = 1:nbars
    x(i,:) = b(i).XEndPoints;
end
% Plot the errorbars
errorbar(x',A,Errors,'k','linestyle','none');
%%%%%%%%%%%%%%%


% AA=gca;
% A.YScale='log'
%  axis([0 600 0 20])

% xlabel('T (K)')
        ylabel('\chi')
        legtext={'AAA-1 Our Results','AAA-1 + 10%PS','Greenfield 2014','Experimental','Greenfield 2007'}
        legtext={'PE','PB','PP','PS','PVC'}
        leg=legend(legtext)
        h1=gca;
        set(gcf, 'units', 'inches', 'pos', [3.1895 3.9368 17.505 10.916])

        legend boxoff
        set(gca,'FontSize',16)
        set(gcf,'color','w');
        set(gca,'color','None');
        box on
        set(leg,'FontSize',14);
        set(h1,'TickLength',[.02 .1])
        set(h1,'XMinorTick','on')
        
        %          export_fig 'Rt_example' -png -r800 -a1
        
        ylim([-0.2 1.5])
